<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
    <title></title>
  </head>
  <body>
    <table style="width:50%" style="height:50%" id="lunchTable">
      <thead>
        <th>Jméno</th><th>Třída</th><th>Oběd</th><th>Stav</th>
      </thead>
      <tr>
        <th id="jmeno"></th><th id="trida"></th><th id="obed"></th><th id="stav"></th>
      </tr>
    </table>

    <table id="pocet_obedu">
      <tr>
        <th>Jedničky:</th><th id="pocet_jednicek"></th>
      </tr>

      <tr>
        <th>Dvojky:</th><th id="pocet_dvojek"></th>
      </tr>
    </table>

  </body>
  <script type="text/javascript" charset="utf-8">


      var socket = io.connect("http://192.168.1.144:5000"); //sem dát správnou ip
      socket.on("connect", function() {
        console.log("connect")
        socket.emit("connected", {data: "ping"});
      });

      socket.on("connection_established"  , function() {
        console.log("connection_established");
      });

      socket.on('vydany_obed', function(obedy){
        console.log(obedy);
        document.getElementById("pocet_jednicek").innerHTML = obedy.jednicky;
        document.getElementById("pocet_dvojek").innerHTML = obedy.dvojky;
      });

      socket.on("a_ven", function(data){
        console.log(data.stravnik[0]);

        if (confirm(data.stravnik[0] + " tu je mimo rozvrh. Vydat Oběd?")); {
          socket.emit("vydano", data);
          alert("Vydáno");

        };
      });

      socket.on("pip", function(stravnici){
        console.log(stravnici)
        var rows = (document.getElementById("lunchTable").getElementsByTagName("tr").length) - 1; //counts lenght of existing table - 1(head)
        for (var i = 0; i < rows; i++) {
          document.getElementById("lunchTable").deleteRow(1); //deletes all rows below thead
            }

        for (var i = 0; i <stravnici.length; i++) {
          var table = document.getElementById("lunchTable");
          var row = table.insertRow(i+1);
          var cells = new Array(stravnici[i].length);

          for(var j = 0; j < stravnici[i].length; j++)  {
            cells[j] = row.insertCell(j);
            cells[j].innerHTML = stravnici[i][j];
            }
          }
        });

  </script>
</html>
